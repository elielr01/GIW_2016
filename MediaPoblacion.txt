def MediaGasto(cur):
    #cogemos el comprador y  el libro que ha comprado
    cur.execute("SELECT comprador, libro FROM Compras")
    poblaciones = dict()
    #cogemos lo que ha costado ese libro y lo vamos añadiendo a una lista de importes asociados a la poblacion del comprador
    for (compradores,libros) in cur.fetchall():
        cur.execute("SELECT importe FROM Libros WHERE registro = ?", [libros])
        importe = cur.fetchone()
        cur.execute("SELECT poblacion FROM Compradores WHERE registro = ?", [compradores])
        poblacion = cur.fetchone()
        if(poblacion not in poblaciones):
            poblaciones[poblacion] = []
        poblaciones[poblacion].append(importe)
        #volvemos a hacer la consulta porque el cur ha cambiado con las consultas anteriores
        cur.execute("SELECT comprador, libro FROM Compras")

    #inicializamos el diccionario que asociara la media con la poblacion y las variables que nos permitiran calcularla
    mediaVentasPorPoblacion = dict()
    total = 0
    acumulado = 0
    for poblacion in poblaciones:
        for importe in poblaciones[poblacion]:
            total += 1
            acumulado += importe
        #calculamos la media y se la asignamos a la poblacion
        media = acumulado/total
        mediaVentasPorPoblacion[poblacion] = media
        
    #lo ordenamos y lo imprimimos por pantalla
    mediaVentasPorPoblacion.sort()
    print mediaVentasPorPoblacion